<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Catch the Falling Objects</title>
<style>
  :root{
    --bg:#333;         /* dark gray background */
    --card:#1f2937;
    --text:#ffffff;    /* large white text */
    --muted:#cbd5e1;
    --good:#3aa7ff;    /* blue circles */
    --bad:#ef4444;     /* red squares */
    --paddle:#22c55e;  /* bright green paddle */
    --accent:#60a5fa;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    display:grid;
    place-items:center;
    min-height:100dvh;
    padding:18px;
  }
  .wrap{
    width:min(840px,96vw);
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.12);
    border-radius:16px;
    padding:18px;
  }
  h1{margin:0 0 8px;font-size:clamp(20px,2.5vw + 12px,32px)}
  p.sub{margin:0 0 10px;color:var(--muted)}
  .grid{display:grid;grid-template-columns:1fr 160px;gap:10px}
  input{
    width:100%;
    background:#0b1220;
    color:var(--text);
    border:1px solid rgba(255,255,255,.2);
    padding:12px 14px;border-radius:12px;
  }
  button{
    border:0;border-radius:12px;cursor:pointer;
    padding:12px 14px;font-weight:700;
    background:linear-gradient(90deg,#10b981,#22c55e);
    color:#062016;box-shadow:0 10px 18px rgba(34,197,94,.25);
  }
  button.ghost{background:transparent;color:var(--muted);border:1px dashed rgba(255,255,255,.25);box-shadow:none}
  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .hud{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin:10px 0;color:var(--muted)}
  .hud b{color:var(--text)}
  canvas{width:100%;height:460px;background:#0b1220;border-radius:14px;display:block}
  .center{display:flex;justify-content:center;align-items:center}
  .hidden{display:none !important}
  footer{margin-top:10px;color:var(--muted);font-size:12px;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <h1>üïπÔ∏è Catch the Falling Objects</h1>
    <p class="sub">Move the paddle to catch blue circles (+10). Avoid red squares (‚Äì5). You have 30 seconds!</p>

    <!-- Setup -->
    <section id="setup">
      <div class="grid">
        <input id="playerName" type="text" placeholder="Enter your name‚Ä¶" autocomplete="off" />
        <button id="startBtn">Start Game</button>
      </div>
      <div class="row">
        <button id="demoBtn" class="ghost">Use Demo Name</button>
      </div>
    </section>

    <!-- Game UI -->
    <section id="ui" class="hidden">
      <div class="hud">
        <span>Player: <b id="nameLabel"></b></span>
        <span>Score: <b id="scoreLabel">0</b></span>
        <span>Time: <b id="timeLabel">30.0</b>s</span>
      </div>
      <canvas id="game" width="800" height="460" aria-label="Game canvas"></canvas>
      <div class="row">
        <button id="againBtn" class="hidden">Play Again</button>
        <button id="changeBtn" class="ghost hidden">Change Name</button>
      </div>
      <footer>Tip: Move your mouse (or drag on touch) to control the paddle.</footer>
    </section>
  </div>

<script>
(() => {
  // Elements
  const setup = document.getElementById('setup');
  const startBtn = document.getElementById('startBtn');
  const demoBtn = document.getElementById('demoBtn');
  const nameInput = document.getElementById('playerName');

  const ui = document.getElementById('ui');
  const nameLabel = document.getElementById('nameLabel');
  const scoreLabel = document.getElementById('scoreLabel');
  const timeLabel = document.getElementById('timeLabel');
  const againBtn = document.getElementById('againBtn');
  const changeBtn = document.getElementById('changeBtn');

  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  // Layout helpers ‚Äì keep canvas crisp on HiDPI devices
  const fitCanvas = () => {
    const ratio = window.devicePixelRatio || 1;
    const cssWidth = canvas.clientWidth;
    const cssHeight = canvas.clientHeight;
    canvas.width = Math.round(cssWidth * ratio);
    canvas.height = Math.round(cssHeight * ratio);
    ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
  };
  fitCanvas();
  window.addEventListener('resize', fitCanvas);

  // Game state
  const state = {
    running:false,
    over:false,
    name:"",
    score:0,
    time:30,           // seconds
    last:0,
    spawnAcc:0,
    paddle:{ x: canvas.clientWidth/2, y: canvas.clientHeight-18, w:120, h:14 },
    objects:[],        // falling objects
  };

  // Spawn parameters
  const SPAWN_EVERY = 550; // ms
  const SPEED_BASE = 120;  // px/s base fall speed
  const SPEED_GROW = 26;   // speed increases each 10s
  const MIN_GAP = 36;      // pixels between newly spawned objects
  const GOOD_CHANCE = 0.7; // 70% circles, 30% squares

  // Controls: mouse & touch
  const pointerToX = (evt) => {
    const rect = canvas.getBoundingClientRect();
    let x;
    if(evt.touches && evt.touches[0]){
      x = evt.touches[0].clientX - rect.left;
    } else {
      x = evt.clientX - rect.left;
    }
    return Math.max(0, Math.min(canvas.clientWidth, x));
  };
  const movePaddle = (x) => {
    const w = state.paddle.w;
    state.paddle.x = Math.max(w/2, Math.min(canvas.clientWidth - w/2, x));
  };
  canvas.addEventListener('mousemove', (e)=> movePaddle(pointerToX(e)));
  canvas.addEventListener('touchstart', (e)=> { movePaddle(pointerToX(e)); e.preventDefault(); }, {passive:false});
  canvas.addEventListener('touchmove', (e)=> { movePaddle(pointerToX(e)); e.preventDefault(); }, {passive:false});

  // Utils
  const rand = (min,max) => Math.random()*(max-min)+min;
  const spawnObject = () => {
    // ensure some spacing from existing objects
    let tries = 0, x;
    do {
      x = rand(20, canvas.clientWidth - 20);
      tries++;
      if(tries > 20) break;
    } while (state.objects.some(o => Math.abs(o.x - x) < MIN_GAP));

    const isGood = Math.random() < GOOD_CHANCE;
    state.objects.push({
      kind: isGood ? 'good':'bad',
      x, y: -20,
      r: isGood ? 12 : 14, // radius for circle and half-size for square
      gone:false
    });
  };

  // Collision helpers
  const collideCircleRect = (cx,cy,r, rx,ry,rw,rh) => {
    const closestX = Math.max(rx, Math.min(cx, rx + rw));
    const closestY = Math.max(ry, Math.min(cy, ry + rh));
    const dx = cx - closestX;
    const dy = cy - closestY;
    return (dx*dx + dy*dy) <= r*r;
  };
  const collideSquareRect = (sx,sy,hs, rx,ry,rw,rh) => {
    const left = sx - hs, top = sy - hs, size = hs*2;
    return !(left+size < rx || left > rx+rw || top+size < ry || top > ry+rh);
  };

  // Drawing
  const draw = () => {
    // clear
    ctx.clearRect(0,0,canvas.clientWidth,canvas.clientHeight);

    // paddle
    ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--paddle').trim();
    const px = state.paddle.x - state.paddle.w/2;
    const py = state.paddle.y - state.paddle.h/2;
    ctx.fillRect(px, py, state.paddle.w, state.paddle.h);

    // objects
    for(const o of state.objects){
      if(
